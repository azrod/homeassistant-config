# binary_sensor.zigate_00158d0002c63823_presence:
#   friendly_name: IR BAL
# 
# binary_sensor.zigate_00158d0002b6e6d7_presence:
#   friendly_name: IR porte
# 
# binary_sensor.zigate_00158d00032bd376_presence:
#   friendly_bame: IR terrasse 1
# 
# binary_sensor.zigate_00158d0002f3c9b8_presence:
#   friendly_name: IR terrasse 2

- id: ir_parking_on
  alias: "[Eclairage extérieur] Alumage Auto Parking"
  trigger:
    - platform: state
      entity_id: binary_sensor.zigate_00158d0002c63823_presence # IR BAL
      from: 'off'
      to: 'on'
    - platform: state
      entity_id: binary_sensor.zigate_00158d0002b6e6d7_presence # IR PORTE
      from: 'off'
      to: 'on'
  condition: 
    condition: sun
    after: sunset
  action:
    - service: light.turn_on
      data:
        entity_id:
          - light.fibaro_system_fgd212_dimmer_2_level_2

- id: ir_parking_off
  alias: "[Eclairage extérieur] Extinction Auto Parking"
  trigger:
    - platform: state
      entity_id: binary_sensor.zigate_00158d0002c63823_presence # IR BAL
      from: 'on'
      to: 'off'
      for:
        minutes: 3
    - platform: state
      entity_id: binary_sensor.zigate_00158d0002b6e6d7_presence # IR PORTE
      from: 'on'
      to: 'off'
      for:
        minutes: 3
  condition: 
    condition: sun
    after: sunset
  action:
    - service: light.turn_off
      data:
        entity_id:
          - light.fibaro_system_fgd212_dimmer_2_level_2

- id: ir_home_on
  alias: "[Eclairage extérieur] Alumage Auto Maison"
  trigger:
    - platform: state
      entity_id: binary_sensor.zigate_00158d0002b6e6d7_presence # IR porte
      from: 'off'
      to: 'on'
    - platform: state
      entity_id: binary_sensor.zigate_00158d00032bd376_presence # IR terrasse 1
      from: 'off'
      to: 'on'
    - platform: state
      entity_id: binary_sensor.zigate_00158d00032bd376_presence # IR terrasse 2
      from: 'off'
      to: 'on'
  condition: 
    condition: sun
    after: sunset   
  action:
    - service: light.turn_on
      data:
        entity_id:
          - light.fibaro_system_fgd212_dimmer_2_level_2
          - light.qubino_zmnhdd1_z_wave_plus_flush_dimmer_level


- id: ir_home_off
  alias: "[Eclairage extérieur] Extinction Auto Maison"
  trigger:
    - platform: time_pattern
      minutes: '/2'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: binary_sensor.zigate_00158d0002b6e6d7_presence # IR porte
        state: 'off'
        for:
          minutes: 10
      - condition: state
        entity_id: binary_sensor.zigate_00158d0002b6e6d7_presence # IR terrasse 1
        state: 'off'
        for:
          minutes: 10
      - condition: state
        entity_id: binary_sensor.zigate_00158d0002b6e6d7_presence # IR terrasse 2
        state: 'off'
        for:
          minutes: 10
  action:
    - service: light.turn_off
      data:
        entity_id:
          - light.fibaro_system_fgd212_dimmer_2_level_2
          - light.qubino_zmnhdd1_z_wave_plus_flush_dimmer_level


